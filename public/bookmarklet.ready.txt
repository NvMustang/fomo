javascript:!function(){"use strict";window.location.href.includes("/events/")&&window.location.hostname.includes("facebook.com")?window.__FOMO_BOOKMARKLET_ACTIVE||(window.__FOMO_BOOKMARKLET_ACTIVE=!0,async function(){try{!function(e,t,o){const n=document.createElement("div");n.id="fomo-bookmarklet-modal",n.style.cssText="\n            position: fixed;\n            top: 20px;\n            left: 20px;\n            width: 400px;\n            max-height: calc(100vh - 40px);\n            background: white;\n            border-radius: 8px;\n            padding: 20px;\n            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n            z-index: 999999;\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            display: flex;\n            flex-direction: column;\n            overflow: hidden;\n        ";const r=document.createElement("div");r.style.cssText="\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 16px;\n            flex-shrink: 0;\n            cursor: move;\n            user-select: none;\n        ";const a=document.createElement("h2");a.textContent="ğŸ“… Ajouter l'Ã©vÃ©nement Ã  FOMO",a.style.cssText="margin: 0; font-size: 18px; color: #333; flex: 1;";const s=document.createElement("button");s.type="button",s.innerHTML="Ã—",s.style.cssText="\n            background: none;\n            border: none;\n            font-size: 28px;\n            color: #666;\n            cursor: pointer;\n            padding: 0;\n            width: 30px;\n            height: 30px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            line-height: 1;\n            border-radius: 4px;\n        ",s.onclick=()=>{document.body.contains(n)&&document.body.removeChild(n),window.__FOMO_BOOKMARKLET_ACTIVE=!1,o()},s.onmouseover=()=>{s.style.background="#f0f0f0"},s.onmouseout=()=>{s.style.background="none"},r.appendChild(a),r.appendChild(s);let l=!1,i=0,c=0,d=0,u=0;r.onmousedown=e=>{if("BUTTON"===e.target.tagName||e.target.closest("button"))return;l=!0,i=e.clientX,c=e.clientY;const t=n.getBoundingClientRect();d=t.left,u=t.top,n.style.transition="none",document.body.style.userSelect="none"},document.addEventListener("mousemove",e=>{if(!l)return;e.preventDefault();const t=e.clientX-i,o=e.clientY-c;let r=d+t,a=u+o;const s=window.innerWidth-n.offsetWidth,m=window.innerHeight-n.offsetHeight;r=Math.max(0,Math.min(r,s)),a=Math.max(0,Math.min(a,m)),n.style.left=r+"px",n.style.top=a+"px",n.style.right="auto",n.style.bottom="auto"}),document.addEventListener("mouseup",()=>{l&&(l=!1,n.style.transition="",document.body.style.userSelect="")});const m=document.createElement("div");m.style.cssText="\n            overflow-y: auto;\n            overflow-x: hidden;\n            flex: 1;\n            padding-right: 8px;\n        ";const p=document.createElement("form");function v(e,t,o,n=!1,r="text"){const a=document.createElement("div");a.style.cssText="display: flex; flex-direction: column; gap: 4px;";const s=document.createElement("label");let l;return s.textContent=e+(n?" *":""),s.style.cssText="font-weight: 600; color: #555; font-size: 14px;","textarea"===r?(l=document.createElement("textarea"),l.rows=4):(l=document.createElement("input"),l.type=r),l.name=t,"number"===r?(l.value=null!=o?o+"":"0",l.min="0"):l.value=o||"",l.required=n,l.style.cssText="\n                padding: 6px 10px;\n                border: 1px solid #ddd;\n                border-radius: 4px;\n                font-size: 13px;\n                font-family: inherit;\n                width: 100%;\n                box-sizing: border-box;\n            ",a.appendChild(s),a.appendChild(l),{container:a,input:l}}p.style.cssText="display: flex; flex-direction: column; gap: 12px;";const g=v("URL","url",e.url,!0);g.input.readOnly=!0,g.input.style.background="#f5f5f5";const k=v("Titre","title",e.title,!0),O=v("Description","description",e.description,!0,"textarea");let h="",f="";if(e.start)try{console.log("ğŸ“… [FOMO Bookmarklet] Date dÃ©but ISO reÃ§ue:",e.start);const t=new Date(e.start);if(isNaN(t.getTime()))console.warn("âš ï¸ [FOMO Bookmarklet] Date dÃ©but invalide:",e.start);else{const e=t.getFullYear();h=`${e}-${(t.getMonth()+1+"").padStart(2,"0")}-${(t.getDate()+"").padStart(2,"0")}T${(t.getHours()+"").padStart(2,"0")}:${(t.getMinutes()+"").padStart(2,"0")}`,console.log("ğŸ“… [FOMO Bookmarklet] Date dÃ©but convertie pour datetime-local:",h)}}catch(t){console.error("âŒ [FOMO Bookmarklet] Erreur conversion date dÃ©but:",t,e.start)}else console.warn("âš ï¸ [FOMO Bookmarklet] Pas de date dÃ©but dans eventData");if(e.end)try{console.log("ğŸ“… [FOMO Bookmarklet] Date fin ISO reÃ§ue:",e.end);const t=new Date(e.end);if(isNaN(t.getTime()))console.warn("âš ï¸ [FOMO Bookmarklet] Date fin invalide:",e.end);else{const e=t.getFullYear();f=`${e}-${(t.getMonth()+1+"").padStart(2,"0")}-${(t.getDate()+"").padStart(2,"0")}T${(t.getHours()+"").padStart(2,"0")}:${(t.getMinutes()+"").padStart(2,"0")}`,console.log("ğŸ“… [FOMO Bookmarklet] Date fin convertie pour datetime-local:",f)}}catch(t){console.error("âŒ [FOMO Bookmarklet] Erreur conversion date fin:",t,e.end)}const x=v("Date de dÃ©but (ISO)","start",h||e.start,!0,"datetime-local"),y=v("Date de fin (ISO)","end",f||e.end,!1,"datetime-local"),b=v("Nom du lieu","venue_name",e.venue_name,!1),M=v("Adresse du lieu","address",e.address,!0),w=v("Organisateur","host",e.host,!1),F=v("Image de couverture (URL)","cover",e.cover,!0),C=v("Nombre de participants","attending_count",e.attending_count||"",!1,"text"),B=v("Nombre d'intÃ©ressÃ©s","interested_count",e.interested_count||"",!1,"text");console.log("ğŸ“… [FOMO Bookmarklet] Valeur finale champ date dÃ©but:",x.input.value),console.log("ğŸ“… [FOMO Bookmarklet] Valeur finale champ date fin:",y.input.value),p.appendChild(g.container),p.appendChild(k.container),p.appendChild(O.container),p.appendChild(x.container),p.appendChild(y.container),p.appendChild(b.container),p.appendChild(M.container),p.appendChild(w.container),p.appendChild(F.container),p.appendChild(C.container),p.appendChild(B.container),m.appendChild(r),m.appendChild(p);const S=document.createElement("div");S.style.cssText="display: flex; gap: 12px; justify-content: flex-end; margin-top: 16px; padding-top: 16px; border-top: 1px solid #eee; flex-shrink: 0;";const I=document.createElement("button");I.type="button",I.textContent="Annuler",I.style.cssText="\n            padding: 8px 16px;\n            border: 1px solid #ccc;\n            background: #f5f5f5;\n            color: #333;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 14px;\n            min-width: 80px;\n            flex-shrink: 0;\n        ",I.onclick=()=>{document.body.contains(n)&&document.body.removeChild(n),window.__FOMO_BOOKMARKLET_ACTIVE=!1,o()};const E=document.createElement("button");E.type="button",E.textContent="Envoyer",E.style.cssText="\n            padding: 8px 16px;\n            border: none;\n            background: #1877f2;\n            color: white;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 14px;\n            font-weight: 600;\n            min-width: 80px;\n            flex-shrink: 0;\n        ",E.onclick=()=>{console.log("ğŸ”˜ [FOMO Bookmarklet] Bouton Envoyer cliquÃ©");const e=new Event("submit",{bubbles:!0,cancelable:!0});p.dispatchEvent(e)},S.appendChild(I),S.appendChild(E),p.onsubmit=async e=>{if(e.preventDefault(),console.log("ğŸ”˜ [FOMO Bookmarklet] Formulaire soumis"),!k.input.value.trim())return void alert("Le titre est obligatoire");if(!O.input.value.trim())return void alert("La description est obligatoire");if(!x.input.value.trim())return void alert("La date de dÃ©but est obligatoire");if(!M.input.value.trim())return void alert("L'adresse est obligatoire (nÃ©cessaire pour le gÃ©ocodage)");if(!F.input.value.trim())return void alert("L'image de couverture est obligatoire");let t=x.input.value;if("datetime-local"===x.input.type)try{const e=new Date(x.input.value);isNaN(e.getTime())||(t=e.toISOString())}catch(e){return void alert("Format de date invalide")}let o=y.input.value;if(y.input.value&&"datetime-local"===y.input.type)try{const e=new Date(y.input.value);isNaN(e.getTime())||(o=e.toISOString())}catch(e){o=""}const n={source:"facebook",url:g.input.value.trim(),title:k.input.value.trim(),description:O.input.value.trim(),start:t,address:M.input.value.trim(),cover:F.input.value.trim()};o&&o.trim()&&(n.end=o);const r=b.input.value.trim();r&&(n.venue_name=r);const a=w.input.value.trim();a&&(n.host=a);const s=C.input.value.trim();s&&(n.attending_count=s);const l=B.input.value.trim();l&&(n.interested_count=l),E.disabled=!0,E.textContent="Envoi...",console.log("ğŸ“¤ [FOMO Bookmarklet] Envoi du payload:",n);try{await(async e=>{console.log("ğŸš€ [FOMO Bookmarklet] Callback onConfirm appelÃ© avec payload:",e);try{const t=await function(e,t){return console.log("ğŸ“¤ [FOMO Bookmarklet] Envoi des donnÃ©es via formulaire POST..."),new Promise((o,n)=>{const r="undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():`req_${Date.now()}_${Math.random().toString(36).substring(2,8)}`,a=window.location.origin,s=document.createElement("form");s.method="POST",s.action="https://fomo-swart.vercel.app/api/ingest/event-form",s.target="fomo-bookmarklet-receiver",s.style.cssText="position: absolute; left: -9999px; opacity: 0; pointer-events: none;";const l=document.createElement("input");l.type="hidden",l.name="apiKey",l.value=t,s.appendChild(l);const i=document.createElement("input");i.type="hidden",i.name="requestId",i.value=r,s.appendChild(i);const c=document.createElement("input");c.type="hidden",c.name="expectedOrigin",c.value=a,s.appendChild(c);for(const[t,o]of Object.entries(e))if(null!=o){const e=document.createElement("input");e.type="hidden",e.name=t,e.value="string"==typeof o?o:JSON.stringify(o),s.appendChild(e)}document.body.appendChild(s);let d=null;const u=e=>{console.log("ğŸ“¨ [FOMO Bookmarklet] Message reÃ§u:",{origin:e.origin,type:e.data?.type,requestId:e.data?.requestId,expectedRequestId:r});const t=["https://fomo-swart.vercel.app"];if(t.some(t=>{const o=t.replace("https://","").replace("http://","").split(":")[0];return e.origin.includes(o)})){if("FOMO_INGEST_RESPONSE"===e.data?.type&&e.data?.requestId===r){console.log("âœ… [FOMO Bookmarklet] RÃ©ponse reÃ§ue:",e.data),d&&clearTimeout(d),window.removeEventListener("message",u),document.body.contains(s)&&document.body.removeChild(s);try{const e=window.open("","fomo-bookmarklet-receiver");e&&!e.closed&&e.close()}catch(e){}e.data.ok?o({ok:!0,id:e.data.id,duplicate:e.data.duplicate||!1}):n(Error(e.data.error||"Erreur inconnue"))}}else console.log("âš ï¸ [FOMO Bookmarklet] Message ignorÃ© - origine incorrecte:",e.origin,"attendu:",t)};window.addEventListener("message",u),console.log("ğŸ“¤ [FOMO Bookmarklet] Soumission du formulaire POST..."),console.log("ğŸ“¤ [FOMO Bookmarklet] RequestId:",r),console.log("ğŸ“¤ [FOMO Bookmarklet] ExpectedOrigin:",a),s.submit(),setTimeout(()=>{try{const e=window.open("","fomo-bookmarklet-receiver");e&&!e.closed?console.log("âœ… [FOMO Bookmarklet] Popup ouverte avec succÃ¨s"):console.warn("âš ï¸ [FOMO Bookmarklet] Popup non accessible ou fermÃ©e")}catch(e){console.warn("âš ï¸ [FOMO Bookmarklet] Impossible de vÃ©rifier la popup:",e)}},500),d=setTimeout(()=>{console.warn("âš ï¸ [FOMO Bookmarklet] Timeout aprÃ¨s 10 secondes - pas de rÃ©ponse du serveur"),window.removeEventListener("message",u),document.body.contains(s)&&document.body.removeChild(s),n(Error("Timeout - la popup n'a pas rÃ©pondu. VÃ©rifiez que les popups ne sont pas bloquÃ©es."))},1e4)})}(e,"LaFomoCrew");console.log("âœ… [FOMO Bookmarklet] Ã‰vÃ©nement crÃ©Ã©:",t);const o=document.querySelector("#fomo-bookmarklet-modal");if(o){const e=o.querySelector("div");if(e){const n=document.createElement("div");n.style.cssText="\n                                padding: 12px;\n                                margin-top: 12px;\n                                border-radius: 4px;\n                                background: #d4edda;\n                                color: #155724;\n                                font-size: 14px;\n                                text-align: center;\n                            ",t.ok?t.duplicate?n.textContent="âš ï¸ Doublon dÃ©tectÃ©. L'Ã©vÃ©nement existe dÃ©jÃ  âœ…\nID: "+t.id:n.textContent="Ã‰vÃ©nement envoyÃ© âœ…\nID: "+t.id:(n.style.background="#f8d7da",n.style.color="#721c24",n.textContent="âŒ Erreur: "+(t.error||"Erreur inconnue")),e.appendChild(n),setTimeout(()=>{o&&document.body.contains(o)&&document.body.removeChild(o),window.__FOMO_BOOKMARKLET_ACTIVE=!1},1e3)}else t.ok?t.duplicate?alert("âš ï¸ Doublon dÃ©tectÃ©. L'Ã©vÃ©nement existe dÃ©jÃ  âœ…\nID: "+t.id):alert("Ã‰vÃ©nement envoyÃ© âœ…\nID: "+t.id):alert("âŒ Erreur: "+(t.error||"Erreur inconnue")),o&&document.body.contains(o)&&document.body.removeChild(o),window.__FOMO_BOOKMARKLET_ACTIVE=!1}else t.ok?t.duplicate?alert("âš ï¸ Doublon dÃ©tectÃ©. L'Ã©vÃ©nement existe dÃ©jÃ  âœ…\nID: "+t.id):alert("Ã‰vÃ©nement envoyÃ© âœ…\nID: "+t.id):alert("âŒ Erreur: "+(t.error||"Erreur inconnue")),window.__FOMO_BOOKMARKLET_ACTIVE=!1}catch(e){console.error("âŒ [FOMO Bookmarklet] Erreur dans callback onConfirm:",e);const t=document.querySelector("#fomo-bookmarklet-modal");if(t){const o=t.querySelector("div");if(o){const t=document.createElement("div");t.style.cssText="\n                                padding: 12px;\n                                margin-top: 12px;\n                                border-radius: 4px;\n                                background: #f8d7da;\n                                color: #721c24;\n                                font-size: 14px;\n                                text-align: center;\n                            ",t.textContent="âŒ Erreur: "+(e.message||"Erreur inconnue"),o.appendChild(t)}}if(t){const e=t.querySelectorAll('button[type="button"]');for(const t of e)if("Envoi..."===t.textContent.trim()||"Envoyer"===t.textContent.trim()){t.disabled=!1,t.textContent="Envoyer";break}}}})(n),console.log("âœ… [FOMO Bookmarklet] onConfirm terminÃ© avec succÃ¨s")}catch(e){console.error("âŒ [FOMO Bookmarklet] Erreur dans onConfirm:",e),E.disabled=!1,E.textContent="Envoyer",alert("Erreur: "+(e.message||"Erreur inconnue"))}},n.appendChild(m),n.appendChild(S);const A=e=>{"Escape"===e.key&&(document.body.contains(n)&&document.body.removeChild(n),window.__FOMO_BOOKMARKLET_ACTIVE=!1,document.removeEventListener("keydown",A),o())};document.addEventListener("keydown",A),document.body.appendChild(n)}(await async function(){const e={source:"facebook",url:window.location.href,title:"",description:"",start:"",end:"",venue_name:"",address:"",host:"",attending_count:"",interested_count:"",cover:""};try{const t=document.querySelector('[role="main"]')||document.body;if(!e.venue_name||!e.address){console.log("ğŸ“ [FOMO Bookmarklet] === STRATÃ‰GIE ARIA-LABEL (PRIORITAIRE NÂ°1) ==="),console.log("ğŸ“ [FOMO Bookmarklet] Recherche via aria-label de localisation...");const I=t.querySelector('div[aria-label*="Informations de localisation"], div[aria-label*="localisation"]');if(I){console.log("âœ… [FOMO Bookmarklet] Div de localisation trouvÃ© via aria-label");const E=I.querySelectorAll("div.xu06os2.x1ok221b");if(E.length>=2){const A=E[0],j=E[1],T=A.textContent.trim(),L=j.textContent.trim();T&&T.length>2&&200>T.length&&L&&L.length>5&&200>L.length&&(e.title&&(T.toLowerCase()===e.title.toLowerCase()||T.toLowerCase().includes(e.title.toLowerCase())||e.title.toLowerCase().includes(T.toLowerCase()))||(L.includes(",")||/(rue|avenue|boulevard|place|chemin|route|allÃ©e|impasse|street|road|way|drive|france|belgium|belgique)/i.test(L))&&(e.venue_name||(e.venue_name=T,console.log("âœ… [FOMO Bookmarklet] Nom du lieu trouvÃ© via aria-label (divs):",T)),e.address||(e.address=L,console.log("âœ… [FOMO Bookmarklet] Adresse trouvÃ©e via aria-label (divs):",L))))}if(!e.venue_name||!e.address){const D=I.querySelector('a[role="link"]');if(D){console.log("âœ… [FOMO Bookmarklet] Lien trouvÃ© dans le div de localisation, recherche dans le lien...");const q=D.querySelectorAll("div.xu06os2.x1ok221b");if(q.length>=2){const N=q[0],_=q[1],z=N.textContent.trim(),R=_.textContent.trim();z&&z.length>2&&200>z.length&&R&&R.length>5&&200>R.length&&(e.title&&(z.toLowerCase()===e.title.toLowerCase()||z.toLowerCase().includes(e.title.toLowerCase())||e.title.toLowerCase().includes(z.toLowerCase()))||(R.includes(",")||/(rue|avenue|boulevard|place|chemin|route|allÃ©e|impasse|street|road|way|drive|france|belgium|belgique)/i.test(R))&&(e.venue_name||(e.venue_name=z,console.log("âœ… [FOMO Bookmarklet] Nom du lieu trouvÃ© via lien (divs):",z)),e.address||(e.address=R,console.log("âœ… [FOMO Bookmarklet] Adresse trouvÃ©e via lien (divs):",R))))}if(!e.venue_name||!e.address){const V=D.querySelectorAll('span[dir="auto"]'),K=[];for(const H of V){const U=H.textContent.trim();U&&U.length>2&&200>U.length&&!K.includes(U)&&K.push(U)}if(2>K.length){if(1===K.length&&!e.address){const P=K[0];(P.includes(",")||/(rue|avenue|boulevard|place|chemin|route|allÃ©e|impasse|street|road|way|drive|france|belgium|belgique)/i.test(P))&&(e.address=P,console.log("âœ… [FOMO Bookmarklet] Adresse trouvÃ©e via lien (texte unique):",P))}}else{const $=K[0],G=K[1];e.title&&($.toLowerCase()===e.title.toLowerCase()||$.toLowerCase().includes(e.title.toLowerCase())||e.title.toLowerCase().includes($.toLowerCase()))||(G.includes(",")||/(rue|avenue|boulevard|place|chemin|route|allÃ©e|impasse|street|road|way|drive|france|belgium|belgique)/i.test(G))&&(e.venue_name||(e.venue_name=$,console.log("âœ… [FOMO Bookmarklet] Nom du lieu trouvÃ© via lien (spans):",$)),e.address||(e.address=G,console.log("âœ… [FOMO Bookmarklet] Adresse trouvÃ©e via lien (spans):",G)))}}}}}else console.log("âš ï¸ [FOMO Bookmarklet] Div de localisation non trouvÃ© via aria-label")}console.log("ğŸ” [FOMO Bookmarklet] === STRATÃ‰GIE ROLE BUTTON (PRIORITAIRE NÂ°2) ===");const o=t.querySelectorAll('[role="button"]');console.log('ğŸ” [FOMO Bookmarklet] Nombre d\'Ã©lÃ©ments role="button" trouvÃ©s:',o.length);for(const X of o){const Y=X.textContent.trim();if(!Y||10>Y.length)continue;const W=X.querySelectorAll("div.x1e56ztr.x1xmf6yo");let Z=null,J=null,Q=null;if(W.length>=3){const ee=W[0],te=W[1],oe=null!==te.querySelector("h1");if(console.log("ğŸ” [FOMO Bookmarklet] Structure trouvÃ©e:",{structureDivsLength:W.length,hasH1:oe}),oe){const ae=ee.querySelector('span[dir="auto"]');if(console.log("ğŸ” [FOMO Bookmarklet] DateSpan trouvÃ©:",ae?"OUI":"NON"),ae){Z=ae.textContent.trim(),console.log("ğŸ” [FOMO Bookmarklet] Texte brut extrait:",Z);const se=/(?:lundi|mardi|mercredi|jeudi|vendredi|samedi|dimanche|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/i.test(Z),le=/(?:janvier|fÃ©vrier|mars|avril|mai|juin|juillet|aoÃ»t|septembre|octobre|novembre|dÃ©cembre|january|february|march|april|may|june|july|august|september|october|november|december|janv|fÃ©vr|avr|juil|sept|oct|nov|dÃ©c|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i.test(Z),ie=/(?:aujourd'hui|demain|today|tomorrow|du\s+\d{1,2}|\d{1,2}\s+(?:janv|fÃ©vr|mars|avr|mai|juin|juil|aoÃ»t|sept|oct|nov|dÃ©c|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)\.)/i.test(Z);console.log("ğŸ” [FOMO Bookmarklet] Validation:",{hasDayOfWeek:se,hasMonth:le,hasDatePattern:ie,final:se||le||ie}),se||le||ie?console.log("âœ… [FOMO Bookmarklet] Date trouvÃ©e via rÃ¨gle gÃ©nÃ©rale (premier span avant h1):",Z):(console.warn("âš ï¸ [FOMO Bookmarklet] Premier span du premier div ne ressemble pas Ã  une date:",Z),Z&&Z.length>5&&/\d/.test(Z)?console.log("âš ï¸ [FOMO Bookmarklet] Validation Ã©chouÃ©e mais texte acceptÃ© quand mÃªme (sera parsÃ© plus tard):",Z):Z=null)}else console.warn('âš ï¸ [FOMO Bookmarklet] Aucun span[dir="auto"] trouvÃ© dans le premier div')}else console.warn("âš ï¸ [FOMO Bookmarklet] Le deuxiÃ¨me div ne contient pas de h1");const ne=te.querySelector("h1");if(ne)J=ne.textContent.trim();else{const ce=te.querySelector('span[dir="auto"]');ce&&(J=ce.textContent.trim())}const re=W[2].querySelector('span[dir="auto"]');re&&(Q=re.textContent.trim())}if(!Z||!J||!Q){const de=X.querySelectorAll('span[dir="auto"]');if(de.length>=3){const ue=Array.from(de).map(e=>e.textContent.trim()).filter(e=>e&&e.length>0);if(ue.length>=3){const me=ue[0];/(?:lundi|mardi|mercredi|jeudi|vendredi|samedi|dimanche|monday|tuesday|wednesday|thursday|friday|saturday|sunday|\d{1,2}\s+(janvier|fÃ©vrier|mars|avril|mai|juin|juillet|aoÃ»t|septembre|octobre|novembre|dÃ©cembre|january|february|march|april|may|june|july|august|september|october|november|december)|aujourd'hui|demain|today|tomorrow|du\s+\d{1,2})/i.test(me)&&(Z||(Z=me),J||(J=ue[1]),Q||(Q=ue[2]))}}}if(Z&&J){if(console.log('âœ… [FOMO Bookmarklet] Ã‰lÃ©ment role="button" avec structure Date/Titre/Adresse trouvÃ©'),console.log("ğŸ“… [FOMO Bookmarklet] Texte 1 (Date):",Z),console.log("ğŸ“ [FOMO Bookmarklet] Texte 2 (Titre):",J),console.log("ğŸ“ [FOMO Bookmarklet] Texte 3 (Lieu/Adresse):",Q||"NON TROUVÃ‰"),!e.start&&Z&&(e.start=Z,console.log('ğŸ“… [FOMO Bookmarklet] Date trouvÃ©e via role="button":',Z)),!e.title&&J&&(e.title=J,console.log('âœ… [FOMO Bookmarklet] Titre trouvÃ© via role="button":',J)),Q)if(Q.includes(",")){const pe=Q.split(",").map(e=>e.trim());if(pe.length>=2){const ve=pe[pe.length-2];ve&&ve.length>=2&&100>ve.length&&(e.venue_name||(e.venue_name=ve,console.log('âœ… [FOMO Bookmarklet] Nom du lieu (ville) trouvÃ© via role="button":',ve)))}e.address||(e.address=Q,console.log('âœ… [FOMO Bookmarklet] Adresse trouvÃ©e via role="button":',Q))}else e.venue_name||(e.venue_name=Q,console.log('âœ… [FOMO Bookmarklet] Nom du lieu trouvÃ© via role="button":',Q));if(e.title&&e.start){console.log('âœ… [FOMO Bookmarklet] Extraction via role="button" rÃ©ussie');break}}}console.log("ğŸ” [FOMO Bookmarklet] === STRATÃ‰GIE STRUCTURE CONTENEUR ===");const n=t.querySelectorAll("h1");for(const ge of n){const ke=ge.textContent.trim();if(!ke||3>ke.length||ke.length>200)continue;let Oe=ge.parentElement,he=0;const fe=6;for(;Oe&&fe>he;){const xe=Array.from(Oe.children).filter(e=>"DIV"===e.tagName&&e.children.length>0);if(xe.length>=3){const ye=xe.find(e=>e.contains(ge));if(ye){const be=xe.indexOf(ye);if(xe[0]&&!e.start){const Me=xe[0].textContent.trim();Me&&Me.length>5&&console.log("ğŸ“… [FOMO Bookmarklet] Date trouvÃ©e via structure:",Me)}if(!e.title&&ke&&(e.title=ke,console.log("âœ… [FOMO Bookmarklet] Titre trouvÃ© via structure:",ke)),xe.length>be+1){const we=xe[be+1].textContent.trim();if(we&&we.length>=2&&200>we.length&&(!e.title||we.toLowerCase()!==e.title.toLowerCase()&&!we.toLowerCase().includes(e.title.toLowerCase())&&!e.title.toLowerCase().includes(we.toLowerCase())))if(we.includes(",")){const Fe=we.split(",").map(e=>e.trim());if(Fe.length>=2){const Ce=Fe[Fe.length-2];Ce&&Ce.length>=2&&100>Ce.length&&(e.venue_name||(e.venue_name=Ce,console.log("âœ… [FOMO Bookmarklet] Nom du lieu (ville) trouvÃ© via structure:",Ce)),e.address||(e.address=we,console.log("âœ… [FOMO Bookmarklet] Adresse trouvÃ©e via structure:",we)))}}else e.venue_name||(e.venue_name=we,console.log("âœ… [FOMO Bookmarklet] Nom du lieu trouvÃ© via structure:",we))}if(e.title){console.log("âœ… [FOMO Bookmarklet] Structure conteneur identifiÃ©e et exploitÃ©e");break}}}Oe=Oe.parentElement,he++}if(e.title)break}if(!e.title){const Be=document.querySelector('h1[data-testid="event-permalink-event-name"]');if(Be&&Be.textContent.trim())e.title=Be.textContent.trim();else{const Se=t.querySelectorAll("h1");for(const Ie of Se){const Ee=Ie.textContent.trim();if(Ee&&Ee.length>3&&200>Ee.length){e.title=Ee;break}}}}const r=t.querySelectorAll('[role="button"]');let a=!1;for(const Ae of r){const je=Ae.textContent.trim().toLowerCase(),Te="voir plus"===je||"en voir plus"===je||"see more"===je||je.includes("voir plus")||je.includes("see more"),Le="voir moins"===je||"see less"===je||je.includes("moins")||je.includes("less");if(Te&&!Le)try{console.log('ğŸ”½ [FOMO Bookmarklet] Clic sur bouton "Voir plus" pour dÃ©plier la description:',je),Ae.click(),a=!0,await new Promise(e=>setTimeout(e,500));break}catch(De){console.warn('âš ï¸ [FOMO Bookmarklet] Erreur lors du clic sur "Voir plus":',De)}}a||console.log('â„¹ï¸ [FOMO Bookmarklet] Aucun bouton "Voir plus" trouvÃ© ou description dÃ©jÃ  dÃ©pliÃ©e'),console.log("ğŸ“ [FOMO Bookmarklet] === DÃ‰BUT EXTRACTION DESCRIPTION ===");let s=null;console.log("ğŸ“ [FOMO Bookmarklet] === STRATÃ‰GIE HTML-DIV (PRIORITAIRE) ===");const l=t.querySelectorAll("div.html-div");console.log("ğŸ“ [FOMO Bookmarklet] Nombre de divs html-div trouvÃ©s:",l.length);const i=new Set,c=t.querySelectorAll('[role="button"]');for(const qe of c){const Ne=qe.querySelectorAll("div.x1e56ztr.x1xmf6yo");if(Ne.length>=3){const _e=Ne[0].querySelector('span[dir="auto"]');_e&&i.add(_e);const ze=Ne[1].querySelector("h1");ze&&ze.querySelectorAll('span[dir="auto"]').forEach(e=>i.add(e));const Re=Ne[2].querySelector('span[dir="auto"]');Re&&i.add(Re)}}console.log("ğŸ“ [FOMO Bookmarklet] Spans exclus (dÃ©jÃ  utilisÃ©s pour date/titre/lieu):",i.size);const d=t.querySelectorAll('div[aria-label*="Informations de localisation"], div[aria-label*="localisation"]'),u=new Set,m=new Set;for(const Ve of d){Ve.querySelectorAll('span[dir="auto"]').forEach(e=>m.add(e));const Ke=Ve.closest("div.html-div");Ke&&(u.add(Ke),Ke.querySelectorAll('span[dir="auto"]').forEach(e=>m.add(e)));let He=Ve.parentElement?.nextElementSibling,Ue=0;for(;He&&3>Ue;)He.classList.contains("html-div")&&(u.add(He),He.querySelectorAll('span[dir="auto"]').forEach(e=>m.add(e))),He.querySelectorAll("div.html-div").forEach(e=>{u.add(e),e.querySelectorAll('span[dir="auto"]').forEach(e=>m.add(e))}),He=He.nextElementSibling,Ue++;const Pe=Ve.parentElement;Pe&&Pe.querySelectorAll("div.html-div").forEach(e=>{e===Ke||e.parentElement!==Pe&&e.closest("div.html-div")?.parentElement!==Pe||(u.add(e),e.querySelectorAll('span[dir="auto"]').forEach(e=>m.add(e)))})}console.log("ğŸ“ [FOMO Bookmarklet] Divs html-div exclus (prÃ¨s de la localisation):",u.size),console.log("ğŸ“ [FOMO Bookmarklet] Spans exclus (dans la section localisation):",m.size);const p=[];for(const $e of l){if(u.has($e))continue;const Ge=$e.querySelectorAll('span[dir="auto"]');for(const Xe of Ge){if(i.has(Xe))continue;if(m.has(Xe))continue;const Ye=Xe.closest("div.html-div");if((!Ye||!u.has(Ye))&&(Xe.getAttribute("style")||"").includes("--x-fontSize: 14px")&&(Xe.querySelectorAll("div.x14z9mp.xat24cr.x1lziwak.x1vvkbs.xtlvy1s").length>0||Xe.querySelectorAll("div.xdj266r.x14z9mp.xat24cr.x1lziwak.x1vvkbs").length>0)){const We=Xe.textContent.trim(),Ze=We.length,Je=Xe.querySelectorAll("div.x14z9mp.xat24cr.x1lziwak.x1vvkbs.xtlvy1s").length,Qe=Xe.querySelectorAll("div.xdj266r.x14z9mp.xat24cr.x1lziwak.x1vvkbs").length,et=Je+Qe,tt=Xe.querySelectorAll('[role="button"], button');let ot=!1;for(const nt of tt){const rt=nt.textContent.trim().toLowerCase();if("voir moins"===rt||"voir plus"===rt||"see less"===rt||"see more"===rt){ot=!0;break}}null!==Xe.closest('[role="button"]')||/(?:lundi|mardi|mercredi|jeudi|vendredi|samedi|dimanche|monday|tuesday|wednesday|thursday|friday|saturday|sunday|\d{1,2}\s+(?:janv|fÃ©vr|mars|avr|mai|juin|juil|aoÃ»t|sept|oct|nov|dÃ©c|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)\.|du\s+\d{1,2})/i.test(We)||!ot&&2>Je&&(1>Je||100>Ze)&&200>Ze||p.push({span:Xe,textLength:Ze,paragraphCount:et,xtlvy1sCount:Je,xdj266rCount:Qe,hasVoirMoins:ot})}}}p.length>0?(p.sort((e,t)=>t.hasVoirMoins!==e.hasVoirMoins?t.hasVoirMoins?1:-1:t.xtlvy1sCount!==e.xtlvy1sCount?t.xtlvy1sCount-e.xtlvy1sCount:t.paragraphCount!==e.paragraphCount?t.paragraphCount-e.paragraphCount:t.textLength-e.textLength),s=p[0].span,console.log("ğŸ“ [FOMO Bookmarklet] âœ… Span trouvÃ© via stratÃ©gie html-div"),console.log("ğŸ“ [FOMO Bookmarklet] Nombre de candidats:",p.length),console.log("ğŸ“ [FOMO Bookmarklet] Span choisi - Voir moins:",p[0].hasVoirMoins,"xtlvy1s:",p[0].xtlvy1sCount,"Paragraphes totaux:",p[0].paragraphCount,"Longueur:",p[0].textLength)):console.log("ğŸ“ [FOMO Bookmarklet] Aucun span trouvÃ© via stratÃ©gie html-div");const v=t.querySelectorAll("div.html-div.xdj266r.x14z9mp.xat24cr.x1lziwak");console.log("ğŸ“ [FOMO Bookmarklet] Nombre de divs html-div.xdj266r trouvÃ©s:",v.length);for(const at of v){const st=at.querySelector('span[dir="auto"][class*="xdmh292"][class*="x15dsfln"][class*="x140p0ai"]');if(st){const lt=st.querySelector("div.xdj266r.x14z9mp.xat24cr.x1lziwak.x1vvkbs"),it=st.querySelectorAll("div.x14z9mp.xat24cr.x1lziwak.x1vvkbs.xtlvy1s").length>0;if(lt||it){s=st,console.log("ğŸ“ [FOMO Bookmarklet] âœ… Span trouvÃ© dans div parent html-div");break}}}if(!s){const ct=new Set,dt=t.querySelectorAll('[role="button"]');for(const pt of dt){const vt=pt.querySelectorAll("div.x1e56ztr.x1xmf6yo");if(vt.length>=3){const gt=vt[0].querySelector('span[dir="auto"]');gt&&ct.add(gt);const kt=vt[1].querySelector("h1");kt&&kt.querySelectorAll('span[dir="auto"]').forEach(e=>ct.add(e));const Ot=vt[2].querySelector('span[dir="auto"]');Ot&&ct.add(Ot)}}const ut=t.querySelectorAll('span[dir="auto"][class*="xdmh292"][class*="x15dsfln"][class*="x140p0ai"]'),mt=[];for(const ht of ut)if(!ct.has(ht)&&null===ht.closest('[role="button"]')&&(ht.querySelectorAll("div.x14z9mp.xat24cr.x1lziwak.x1vvkbs.xtlvy1s").length>0||ht.querySelectorAll("div.xdj266r.x14z9mp.xat24cr.x1lziwak.x1vvkbs").length>0)){const ft=ht.textContent.trim().length,xt=ht.querySelectorAll("div.x14z9mp.xat24cr.x1lziwak.x1vvkbs.xtlvy1s, div.xdj266r.x14z9mp.xat24cr.x1lziwak.x1vvkbs").length;10>ft||mt.push({span:ht,textLength:ft,paragraphCount:xt})}mt.length>0&&(mt.sort((e,t)=>t.paragraphCount!==e.paragraphCount?t.paragraphCount-e.paragraphCount:t.textLength-e.textLength),s=mt[0].span,console.log("ğŸ“ [FOMO Bookmarklet] âœ… Span trouvÃ© via Fallback 1 (classes principales)"),console.log("ğŸ“ [FOMO Bookmarklet] Nombre de candidats:",mt.length),console.log("ğŸ“ [FOMO Bookmarklet] Span choisi - Paragraphes:",mt[0].paragraphCount,"Longueur:",mt[0].textLength))}if(!s){console.log("ğŸ“ [FOMO Bookmarklet] Recherche via style fontSize:14px...");const yt=t.querySelectorAll('span[dir="auto"]');console.log("ğŸ“ [FOMO Bookmarklet] Nombre de spans Ã  analyser:",yt.length);const bt=new Set,Mt=t.querySelectorAll('[role="button"]');for(const Ft of Mt){const Ct=Ft.querySelectorAll("div.x1e56ztr.x1xmf6yo");if(Ct.length>=3){const Bt=Ct[0].querySelector('span[dir="auto"]');Bt&&bt.add(Bt);const St=Ct[1].querySelector("h1");St&&St.querySelectorAll('span[dir="auto"]').forEach(e=>bt.add(e));const It=Ct[2].querySelector('span[dir="auto"]');It&&bt.add(It)}}console.log("ğŸ“ [FOMO Bookmarklet] Spans exclus (dÃ©jÃ  utilisÃ©s pour date/titre/lieu):",bt.size);const wt=[];for(const Et of yt)if(!bt.has(Et)&&(Et.getAttribute("style")||"").includes("--x-fontSize: 14px")){const At=Et.querySelectorAll("div.x14z9mp.xat24cr.x1lziwak.x1vvkbs.xtlvy1s").length>0,jt=Et.querySelectorAll("div.xdj266r.x14z9mp.xat24cr.x1lziwak.x1vvkbs").length>0,Tt=Et.textContent.trim(),Lt=Tt.length>50,Dt=/(?:lundi|mardi|mercredi|jeudi|vendredi|samedi|dimanche|monday|tuesday|wednesday|thursday|friday|saturday|sunday|\d{1,2}\s+(?:janv|fÃ©vr|mars|avr|mai|juin|juil|aoÃ»t|sept|oct|nov|dÃ©c|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)\.|du\s+\d{1,2})/i.test(Tt),qt=null!==Et.closest('[role="button"]');if((At||jt)&&Lt&&!Dt&&!qt){const Nt=Et.querySelectorAll("div.x14z9mp.xat24cr.x1lziwak.x1vvkbs.xtlvy1s, div.xdj266r.x14z9mp.xat24cr.x1lziwak.x1vvkbs").length;10>Tt.length||wt.push({span:Et,textLength:Tt.length,paragraphCount:Nt})}}wt.length>0&&(wt.sort((e,t)=>t.paragraphCount!==e.paragraphCount?t.paragraphCount-e.paragraphCount:t.textLength-e.textLength),s=wt[0].span,console.log("ğŸ“ [FOMO Bookmarklet] âœ… Span trouvÃ© via style fontSize:14px avec divs de description"),console.log("ğŸ“ [FOMO Bookmarklet] Nombre de candidats:",wt.length),console.log("ğŸ“ [FOMO Bookmarklet] Span choisi - Paragraphes:",wt[0].paragraphCount,"Longueur:",wt[0].textLength),console.log("ğŸ“ [FOMO Bookmarklet] Nombre de divs xtlvy1s trouvÃ©s:",s.querySelectorAll("div.x14z9mp.xat24cr.x1lziwak.x1vvkbs.xtlvy1s").length),console.log("ğŸ“ [FOMO Bookmarklet] Nombre de divs xdj266r trouvÃ©s:",s.querySelectorAll("div.xdj266r.x14z9mp.xat24cr.x1lziwak.x1vvkbs").length))}if(s){console.log("ğŸ“ [FOMO Bookmarklet] âœ… Span multi-paragraphes trouvÃ©"),console.log("ğŸ“ [FOMO Bookmarklet] Contenu HTML du span (premiers 500 caractÃ¨res):",s.innerHTML.substring(0,500));const _t=s.cloneNode(!0),zt=_t.querySelectorAll('[role="button"], button, [class*="button"]');console.log("ğŸ“ [FOMO Bookmarklet] Nombre de boutons trouvÃ©s:",zt.length);let Rt=0;zt.forEach(e=>{const t=e.textContent.trim().toLowerCase();(t.includes("voir moins")||t.includes("voir plus")||t.includes("en savoir plus")||t.includes("see more")||t.includes("see less")||"voir plus"===t||"voir moins"===t||"plus"===t||"moins"===t||"more"===t||"less"===t)&&(e.remove(),Rt++)}),console.log("ğŸ“ [FOMO Bookmarklet] Boutons supprimÃ©s:",Rt);const Vt=e=>{const t=e.cloneNode(!0);return t.querySelectorAll("img[alt]").forEach(e=>{const t=e.getAttribute("alt")||"";if(e.parentNode){const o=document.createTextNode(t);try{e.parentNode.replaceChild(o,e)}catch(e){console.warn("âš ï¸ [FOMO Bookmarklet] Erreur remplacement emoji:",e)}}}),t.querySelectorAll("br, br.html-br").forEach(e=>{if(e.parentNode){const t=document.createTextNode("\n");try{e.parentNode.replaceChild(t,e)}catch(e){console.warn("âš ï¸ [FOMO Bookmarklet] Erreur remplacement <br>:",e)}}}),t.textContent.trim()},Kt=[],Ht=_t.querySelectorAll("div.xdj266r.x14z9mp.xat24cr.x1lziwak.x1vvkbs");if(console.log("ğŸ“ [FOMO Bookmarklet] Nombre de divs xdj266r trouvÃ©s:",Ht.length),Ht.length>0){const Gt=Ht[0],Xt=Vt(Gt);console.log("ğŸ“ [FOMO Bookmarklet] Premier div (xdj266r) trouvÃ©"),console.log("ğŸ“ [FOMO Bookmarklet] Texte du premier div (avec emojis):",Xt),console.log("ğŸ“ [FOMO Bookmarklet] HTML du premier div (premiers 200 caractÃ¨res):",Gt.innerHTML.substring(0,200)),Xt&&Xt.length>0?(Kt.push(Xt),console.log("ğŸ“ [FOMO Bookmarklet] âœ… Premier paragraphe ajoutÃ© (longueur:",Xt.length,")")):console.warn("ğŸ“ [FOMO Bookmarklet] âš ï¸ Premier div trouvÃ© mais texte vide aprÃ¨s trim")}else console.log("ğŸ“ [FOMO Bookmarklet] âš ï¸ Aucun div xdj266r trouvÃ©");const Ut=_t.querySelectorAll("div.x14z9mp.xat24cr.x1lziwak.x1vvkbs.xtlvy1s");if(console.log("ğŸ“ [FOMO Bookmarklet] Nombre de divs xtlvy1s trouvÃ©s:",Ut.length),console.log("ğŸ“ [FOMO Bookmarklet] Extraction de tous les paragraphes dans l'ordre du DOM..."),Ut.forEach((e,t)=>{const o=Vt(e);console.log(`ğŸ“ [FOMO Bookmarklet] Div xtlvy1s ${t+1}/${Ut.length} texte complet (avec emojis):`,o),console.log(`ğŸ“ [FOMO Bookmarklet] Div xtlvy1s ${t+1} HTML (premiers 200 caractÃ¨res):`,e.innerHTML.substring(0,200)),o&&o.length>0?(Kt.push(o),console.log(`ğŸ“ [FOMO Bookmarklet] âœ… Paragraphe ${Kt.length} ajoutÃ© (longueur: ${o.length})`)):console.warn(`ğŸ“ [FOMO Bookmarklet] âš ï¸ Div xtlvy1s ${t+1} trouvÃ© mais texte vide aprÃ¨s trim`)}),console.log("ğŸ“ [FOMO Bookmarklet] Total paragraphes extraits:",Kt.length),0===Kt.length){console.log("ğŸ“ [FOMO Bookmarklet] Aucun paragraphe structurÃ© trouvÃ©, recherche fallback dans tous les divs...");const Yt=_t.querySelectorAll("div.x14z9mp.xat24cr.x1lziwak.x1vvkbs");console.log("ğŸ“ [FOMO Bookmarklet] Nombre total de divs x14z9mp.xat24cr.x1lziwak.x1vvkbs trouvÃ©s:",Yt.length),Yt.forEach((e,t)=>{const o=Vt(e);o&&o.length>10&&(Kt.push(o),console.log(`ğŸ“ [FOMO Bookmarklet] âœ… Paragraphe fallback ${Kt.length} ajoutÃ© (avec emojis):`,o.substring(0,50)))})}let Pt="";Kt.length>0?(Pt=Kt.join("\n\n"),console.log("ğŸ“ [FOMO Bookmarklet] Total paragraphes concatÃ©nÃ©s:",Kt.length),console.log("ğŸ“ [FOMO Bookmarklet] Texte avant nettoyage (premiers 500 caractÃ¨res):",Pt.substring(0,500))):(Pt=_t.textContent.trim(),console.log("ğŸ“ [FOMO Bookmarklet] âš ï¸ Aucun paragraphe structurÃ© trouvÃ©, utilisation du texte direct"),console.log("ğŸ“ [FOMO Bookmarklet] Texte direct (premiers 500 caractÃ¨res):",Pt.substring(0,500)));const $t=Pt;Pt=Pt.replace(/\s*(voir\s+(plus|moins)|en\s+savoir\s+plus|see\s+(more|less))\s*/gi,""),Pt=Pt.replace(/\n{3,}/g,"\n\n").trim(),$t!==Pt&&console.log("ğŸ“ [FOMO Bookmarklet] Texte nettoyÃ© (diffÃ©rences dÃ©tectÃ©es)"),Pt&&Pt.length>20?(e.description=Pt.substring(0,2e3),console.log("âœ… [FOMO Bookmarklet] Description assignÃ©e Ã  data.description"),console.log("ğŸ“ [FOMO Bookmarklet] Longueur totale:",Pt.length),console.log("ğŸ“ [FOMO Bookmarklet] Description finale (premiers 500 caractÃ¨res):",e.description.substring(0,500)),console.log("ğŸ“ [FOMO Bookmarklet] Description finale (derniers 200 caractÃ¨res):",e.description.substring(Math.max(0,e.description.length-200)))):(console.warn("âš ï¸ [FOMO Bookmarklet] Texte extrait trop court ou vide"),console.warn("ğŸ“ [FOMO Bookmarklet] Longueur du texte:",Pt?Pt.length:0),console.warn("ğŸ“ [FOMO Bookmarklet] Contenu du texte:",Pt))}else{console.log("â„¹ï¸ [FOMO Bookmarklet] âŒ Span multi-paragraphes non trouvÃ©"),console.log("ğŸ“ [FOMO Bookmarklet] Recherche dans mainContent:",t?"trouvÃ©":"non trouvÃ©");const Wt=t.querySelectorAll('span[dir="auto"]');console.log('ğŸ“ [FOMO Bookmarklet] Nombre total de spans dir="auto" trouvÃ©s:',Wt.length)}console.log("ğŸ“ [FOMO Bookmarklet] Description finale:",e.description?e.description.substring(0,100)+"...":"VIDE"),console.log("ğŸ“… [FOMO Bookmarklet] === DÃ‰BUT EXTRACTION DATES ===");let g=t.querySelector('span[dir="auto"][class*="xdmh292"][class*="x15dsfln"][class*="x140p0ai"][class*="x1yc453h"][class*="x1a1m0xk"][class*="x1xlr1w8"]')||t.querySelector('span[dir="auto"][class*="xdmh292"][class*="x15dsfln"][class*="x140p0ai"][class*="x1gufx9m"][class*="x1s928wv"][class*="x1yc453h"][class*="x1a1m0xk"][class*="x1xlr1w8"]')||t.querySelector('span[dir="auto"][class*="xdmh292"][class*="x15dsfln"][class*="x140p0ai"][class*="x1yc453h"]');if(!g){console.log("ğŸ“… [FOMO Bookmarklet] SÃ©lecteur spÃ©cifique non trouvÃ©, recherche par couleur rouge (zone limitÃ©e)...");let Zt=t;const Jt=document.querySelector('h1[data-testid="event-permalink-event-name"]')||t.querySelector("h1");if(Jt){let eo=Jt.parentElement,to=0;for(;eo&&5>to;){if(Array.from(eo.children).length>=3){Zt=eo,console.log("ğŸ“… [FOMO Bookmarklet] Zone de recherche limitÃ©e au conteneur du titre");break}eo=eo.parentElement,to++}}const Qt=Zt.querySelectorAll('span[dir="auto"]');console.log("ğŸ“… [FOMO Bookmarklet] Nombre de spans Ã  analyser (zone limitÃ©e):",Qt.length);for(const oo of Qt){const no=oo.textContent.trim();if(no&&no.length>5&&100>no.length&&(/(?:lundi|mardi|mercredi|jeudi|vendredi|samedi|dimanche|monday|tuesday|wednesday|thursday|friday|saturday|sunday)\s+\d{1,2}\s+(janvier|fÃ©vrier|mars|avril|mai|juin|juillet|aoÃ»t|septembre|octobre|novembre|dÃ©cembre|january|february|march|april|may|june|july|august|september|october|november|december)\s+\d{4}/i.test(no)||/du\s+\d{1,2}\s+(janv|fÃ©vr|mars|avr|mai|juin|juil|aoÃ»t|sept|oct|nov|dÃ©c|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)\.\s+\d{1,2}:\d{2}\s+au\s+\d{1,2}\s+(janv|fÃ©vr|mars|avr|mai|juin|juil|aoÃ»t|sept|oct|nov|dÃ©c|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)\.\s+\d{1,2}:\d{2}/i.test(no)||/(aujourd'hui|demain|today|tomorrow)\s+(de\s+\d{1,2}:\d{2}\s+Ã \s+\d{1,2}:\d{2}|Ã \s+\d{1,2}:\d{2})/i.test(no)||/(lundi|mardi|mercredi|jeudi|vendredi|samedi|dimanche|monday|tuesday|wednesday|thursday|friday|saturday|sunday)\s+(de\s+\d{1,2}:\d{2}\s+Ã \s+\d{1,2}:\d{2}|Ã \s+\d{1,2}:\d{2})/i.test(no))){const ro=window.getComputedStyle(oo).color;let ao=!1;const so=ro.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*[\d.]+)?\)/);if(so){const lo=parseInt(so[1]),io=parseInt(so[2]),co=parseInt(so[3]);ao=lo>180&&120>io&&120>co,ao&&console.log("ğŸ“… [FOMO Bookmarklet] Date trouvÃ©e par couleur rouge:",no.substring(0,60),"RGB:",{r:lo,g:io,b:co})}else ao=ro.includes("rgb(237, 65, 65)")||ro.includes("rgb(242, 61, 61)")||ro.includes("rgb(220, 29, 29)")||ro.includes("rgb(255, 0, 0)")||ro.includes("rgb(239, 68, 68)");if(ao){g=oo,console.log("âœ… [FOMO Bookmarklet] Date trouvÃ©e par couleur rouge:",no);break}}}}let k=null;if(g?(k=g.textContent.trim(),console.log("ğŸ“… [FOMO Bookmarklet] Texte trouvÃ© via sÃ©lecteur:",k)):!e.start||"string"!=typeof e.start||e.start.includes("T")||e.start.includes("Z")||(k=e.start,console.log('ğŸ“… [FOMO Bookmarklet] Texte trouvÃ© via role="button":',k)),k){let uo=!1;try{let mo=k.match(/du\s+(\d{1,2})\s+([^\s.]+)\.\s+(\d{4})\s+(\d{1,2}):(\d{2})\s+au\s+(\d{1,2})\s+([^\s.]+)\.\s+(\d{4})\s+(\d{1,2}):(\d{2})/i);if(mo){const[,po,vo,go,ko,Oo,ho,fo,xo,yo,bo]=mo;console.log("ğŸ“… [FOMO Bookmarklet] Match trouvÃ© (avec annÃ©e):",{startDay:po,startMonthAbbr:vo,startYear:go,startHour:ko,startMinute:Oo,endDay:ho,endMonthAbbr:fo,endYear:xo,endHour:yo,endMinute:bo});const Mo={janv:0,jan:0,"fÃ©vr":1,"fÃ©v":1,mars:2,mar:2,avr:3,mai:4,juin:5,juil:6,jul:6,"aoÃ»t":7,aout:7,sept:8,oct:9,nov:10,"dÃ©c":11,dec:11,jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11},wo=Mo[vo.toLowerCase()],Fo=Mo[fo.toLowerCase()];if(void 0!==wo&&void 0!==Fo){const Co=new Date(parseInt(go),wo,parseInt(po),parseInt(ko),parseInt(Oo)),Bo=new Date(parseInt(xo),Fo,parseInt(ho),parseInt(yo),parseInt(bo));po===ho&&wo===Fo&&go===xo&&60*parseInt(ko)+parseInt(Oo)>60*parseInt(yo)+parseInt(bo)&&(Bo.setDate(Bo.getDate()+1),console.log("ğŸ“… [FOMO Bookmarklet] Heure de fin < heure de dÃ©but, Ã©vÃ©nement se termine le lendemain")),console.log("ğŸ“… [FOMO Bookmarklet] Dates crÃ©Ã©es - DÃ©but:",Co,"Fin:",Bo),isNaN(Co.getTime())||isNaN(Bo.getTime())?console.warn("âš ï¸ [FOMO Bookmarklet] Dates invalides aprÃ¨s parsing"):(e.start=Co.toISOString(),e.end=Bo.toISOString(),console.log("âœ… [FOMO Bookmarklet] Date dÃ©but extraite:",e.start),console.log("âœ… [FOMO Bookmarklet] Date fin extraite:",e.end)),uo=!0}else console.warn("âš ï¸ [FOMO Bookmarklet] Mois non reconnus:",vo,fo)}if(!uo&&(mo=k.match(/du\s+(\d{1,2})\s+([^\s.]+)\.\s+(\d{1,2}):(\d{2})\s+au\s+(\d{1,2})\s+([^\s.]+)\.\s+(\d{4})\s+(\d{1,2}):(\d{2})/i),mo)){const[,So,Io,Eo,Ao,jo,To,Lo,Do,qo]=mo;console.log("ğŸ“… [FOMO Bookmarklet] Match trouvÃ© (dÃ©but sans annÃ©e, fin avec annÃ©e):",{startDay:So,startMonthAbbr:Io,startHour:Eo,startMinute:Ao,endDay:jo,endMonthAbbr:To,endYear:Lo,endHour:Do,endMinute:qo});const No={janv:0,jan:0,"fÃ©vr":1,"fÃ©v":1,mars:2,mar:2,avr:3,mai:4,juin:5,juil:6,jul:6,"aoÃ»t":7,aout:7,sept:8,oct:9,nov:10,"dÃ©c":11,dec:11,jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11},_o=No[Io.toLowerCase()],zo=No[To.toLowerCase()];if(void 0!==_o&&void 0!==zo){let Ro=parseInt(Lo);(_o>zo||zo===_o&&parseInt(So)>parseInt(jo))&&(Ro=parseInt(Lo)-1);const Vo=new Date(Ro,_o,parseInt(So),parseInt(Eo),parseInt(Ao)),Ko=new Date(parseInt(Lo),zo,parseInt(jo),parseInt(Do),parseInt(qo));So===jo&&_o===zo&&Ro===parseInt(Lo)&&60*parseInt(Eo)+parseInt(Ao)>60*parseInt(Do)+parseInt(qo)&&(Ko.setDate(Ko.getDate()+1),console.log("ğŸ“… [FOMO Bookmarklet] Heure de fin < heure de dÃ©but, Ã©vÃ©nement se termine le lendemain")),console.log("ğŸ“… [FOMO Bookmarklet] Dates crÃ©Ã©es - DÃ©but:",Vo,"Fin:",Ko),isNaN(Vo.getTime())||isNaN(Ko.getTime())?console.warn("âš ï¸ [FOMO Bookmarklet] Dates invalides aprÃ¨s parsing"):(e.start=Vo.toISOString(),e.end=Ko.toISOString(),console.log("âœ… [FOMO Bookmarklet] Date dÃ©but extraite:",e.start),console.log("âœ… [FOMO Bookmarklet] Date fin extraite:",e.end)),uo=!0}else console.warn("âš ï¸ [FOMO Bookmarklet] Mois non reconnus:",Io,To)}if(!uo&&(mo=k.match(/du\s+(\d{1,2})\s+([^\s.]+)\.\s+(\d{1,2}):(\d{2})\s+au\s+(\d{1,2})\s+([^\s.]+)\.\s+(\d{1,2}):(\d{2})/i),mo)){const[,Ho,Uo,Po,$o,Go,Xo,Yo,Wo]=mo;console.log("ğŸ“… [FOMO Bookmarklet] Match trouvÃ©:",{startDay:Ho,startMonthAbbr:Uo,startHour:Po,startMinute:$o,endDay:Go,endMonthAbbr:Xo,endHour:Yo,endMinute:Wo});const Zo={janv:0,jan:0,"fÃ©vr":1,"fÃ©v":1,mars:2,mar:2,avr:3,mai:4,juin:5,juil:6,jul:6,"aoÃ»t":7,aout:7,sept:8,oct:9,nov:10,"dÃ©c":11,dec:11,jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11},Jo=Zo[Uo.toLowerCase()],Qo=Zo[Xo.toLowerCase()];if(void 0!==Jo&&void 0!==Qo){const en=new Date;let tn=en.getFullYear();(Jo<en.getMonth()||Jo===en.getMonth()&&parseInt(Ho)<en.getDate())&&(tn+=1);const on=new Date(tn,Jo,parseInt(Ho),parseInt(Po),parseInt($o)),nn=new Date(tn,Qo,parseInt(Go),parseInt(Yo),parseInt(Wo));Ho===Go&&Jo===Qo&&60*parseInt(Po)+parseInt($o)>60*parseInt(Yo)+parseInt(Wo)&&(nn.setDate(nn.getDate()+1),console.log("ğŸ“… [FOMO Bookmarklet] Heure de fin < heure de dÃ©but, Ã©vÃ©nement se termine le lendemain")),console.log("ğŸ“… [FOMO Bookmarklet] Dates crÃ©Ã©es - DÃ©but:",on,"Fin:",nn),isNaN(on.getTime())||isNaN(nn.getTime())?console.warn("âš ï¸ [FOMO Bookmarklet] Dates invalides aprÃ¨s parsing"):(e.start=on.toISOString(),e.end=nn.toISOString(),console.log("âœ… [FOMO Bookmarklet] Date dÃ©but extraite:",e.start),console.log("âœ… [FOMO Bookmarklet] Date fin extraite:",e.end)),uo=!0}else console.warn("âš ï¸ [FOMO Bookmarklet] Mois non reconnus:",Uo,Xo)}if(!uo){let rn=k.match(/(?:lundi|mardi|mercredi|jeudi|vendredi|samedi|dimanche|monday|tuesday|wednesday|thursday|friday|saturday|sunday)\s+(\d{1,2})\s+([^\s]+)\s+(\d{4})\s+de\s+(\d{1,2}):(\d{2})\s+Ã \s+(\d{1,2}):(\d{2})/i);if(rn){const[,an,sn,ln,cn,dn,un,mn]=rn,pn={janvier:0,"fÃ©vrier":1,mars:2,avril:3,mai:4,juin:5,juillet:6,"aoÃ»t":7,aout:7,septembre:8,octobre:9,novembre:10,"dÃ©cembre":11,january:0,february:1,march:2,april:3,may:4,june:5,july:6,august:7,september:8,october:9,november:10,december:11}[sn.toLowerCase()];if(void 0!==pn){const vn=new Date(parseInt(ln),pn,parseInt(an),parseInt(cn),parseInt(dn)),gn=new Date(parseInt(ln),pn,parseInt(an),parseInt(un),parseInt(mn));60*parseInt(cn)+parseInt(dn)>60*parseInt(un)+parseInt(mn)&&gn.setDate(gn.getDate()+1),isNaN(vn.getTime())||isNaN(gn.getTime())||(e.start=vn.toISOString(),e.end=gn.toISOString(),uo=!0)}}else if(rn=k.match(/(?:lundi|mardi|mercredi|jeudi|vendredi|samedi|dimanche|monday|tuesday|wednesday|thursday|friday|saturday|sunday)\s+(\d{1,2})\s+([^\s]+)\s+(\d{4})\s+Ã \s+(\d{1,2}):(\d{2})/i),rn){const[,kn,On,hn,fn,xn]=rn,yn={janvier:0,"fÃ©vrier":1,mars:2,avril:3,mai:4,juin:5,juillet:6,"aoÃ»t":7,septembre:8,octobre:9,novembre:10,"dÃ©cembre":11,january:0,february:1,march:2,april:3,may:4,june:5,july:6,august:7,september:8,october:9,november:10,december:11}[On.toLowerCase()];if(void 0!==yn){const bn=new Date(parseInt(hn),yn,parseInt(kn),parseInt(fn),parseInt(xn));isNaN(bn.getTime())||(e.start=bn.toISOString(),uo=!0)}}}if(!uo){const Mn=k.match(/(lundi|mardi|mercredi|jeudi|vendredi|samedi|dimanche|monday|tuesday|wednesday|thursday|friday|saturday|sunday)(?:\s+de\s+(\d{1,2}):(\d{2})\s+Ã \s+(\d{1,2}):(\d{2})|\s+Ã \s+(\d{1,2}):(\d{2}))/i);if(Mn){const[,wn,Fn,Cn,Bn,Sn,In,En]=Mn,An={dimanche:0,sunday:0,lundi:1,monday:1,mardi:2,tuesday:2,mercredi:3,wednesday:3,jeudi:4,thursday:4,vendredi:5,friday:5,samedi:6,saturday:6}[wn.toLowerCase()];if(null!==An){const jn=new Date;let Tn=An-jn.getDay();Tn>0||(Tn+=7);const Ln=new Date(jn);if(Ln.setDate(jn.getDate()+Tn),void 0!==Fn){Ln.setHours(parseInt(Fn),parseInt(Cn),0,0),e.start=Ln.toISOString();const Dn=new Date(Ln);Dn.setHours(parseInt(Bn),parseInt(Sn),0,0),60*parseInt(Fn)+parseInt(Cn)>60*parseInt(Bn)+parseInt(Sn)&&Dn.setDate(Dn.getDate()+1),e.end=Dn.toISOString()}else Ln.setHours(parseInt(In),parseInt(En),0,0),e.start=Ln.toISOString();uo=!0}}}if(!uo&&(/(aujourd'hui|today)/i.test(k)||/(demain|tomorrow)/i.test(k))){let qn=new Date(new Date);/(demain|tomorrow)/i.test(k)&&qn.setDate(qn.getDate()+1);const Nn=k.match(/de\s+(\d{1,2}):(\d{2})\s+Ã \s+(\d{1,2}):(\d{2})/i);if(Nn){const[,_n,zn,Rn,Vn]=Nn;qn.setHours(parseInt(_n),parseInt(zn),0,0),e.start=qn.toISOString();const Kn=new Date(qn);Kn.setHours(parseInt(Rn),parseInt(Vn),0,0),60*parseInt(_n)+parseInt(zn)>60*parseInt(Rn)+parseInt(Vn)&&Kn.setDate(Kn.getDate()+1),e.end=Kn.toISOString()}else{const Hn=k.match(/Ã \s+(\d{1,2}):(\d{2})/i);if(Hn){const[,Un,Pn]=Hn;qn.setHours(parseInt(Un),parseInt(Pn),0,0),e.start=qn.toISOString()}}uo=!0}uo||(e.start=k,console.log("ğŸ“… [FOMO Bookmarklet] Aucun pattern reconnu, texte brut conservÃ©:",k))}catch($n){console.error("âŒ [FOMO Bookmarklet] Erreur parsing date:",$n),e.start=k}}else console.log("ğŸ“… [FOMO Bookmarklet] Span spÃ©cifique non trouvÃ©");console.log("ğŸ“… [FOMO Bookmarklet] === RÃ‰SUMÃ‰ EXTRACTION DATES ==="),console.log("ğŸ“… [FOMO Bookmarklet] Date dÃ©but:",e.start||"NON TROUVÃ‰E"),console.log("ğŸ“… [FOMO Bookmarklet] Date fin:",e.end||"NON TROUVÃ‰E"),console.log("ğŸ“… [FOMO Bookmarklet] === FIN EXTRACTION DATES ==="),console.log("ğŸ“ [FOMO Bookmarklet] === DÃ‰BUT EXTRACTION ADRESSE ===");let O=null;const h=document.querySelector('h1[data-testid="event-permalink-event-name"]')||t.querySelector("h1");if(h){let Gn=h.parentElement,Xn=0;for(;Gn&&10>Xn;){const Yn=Gn.querySelector('span[dir="auto"][class*="xdmh292"][class*="x15dsfln"][class*="x140p0ai"]'),Wn=Gn.querySelector('span[dir="auto"][class*="xdmh292"][class*="x15dsfln"][class*="x1yc453h"]');if(Yn||Wn){O=Gn,console.log("ğŸ“ [FOMO Bookmarklet] Conteneur Ã©vÃ©nement trouvÃ©");break}Gn=Gn.parentElement,Xn++}}const f=O;f?console.log("ğŸ“ [FOMO Bookmarklet] Zone de recherche: conteneur Ã©vÃ©nement"):console.warn("ğŸ“ [FOMO Bookmarklet] âš ï¸ Conteneur Ã©vÃ©nement non trouvÃ© - recherche d'adresse dÃ©sactivÃ©e pour Ã©viter les faux positifs");const x=f||t;if(!e.venue_name||!e.address){console.log("ğŸ“ [FOMO Bookmarklet] StratÃ©gie fallback: Recherche via liens et SVG...");const Zn=x.querySelectorAll('a[role="link"]');console.log("ğŸ“ [FOMO Bookmarklet] Nombre de liens trouvÃ©s (fallback):",Zn.length);for(const Jn of Zn){const Qn=Jn.className;if(!Qn.includes("x1i10hfl")||!Qn.includes("x1qjc9v5"))continue;const er=Jn.querySelectorAll('span[dir="auto"]'),tr=[];for(const nr of er){const rr=nr.textContent.trim();rr&&rr.length>2&&200>rr.length&&!tr.includes(rr)&&tr.push(rr)}const or=Jn.querySelectorAll("div.xu06os2.x1ok221b");if(or.length>=2){const ar=or[0],sr=or[1],lr=ar.textContent.trim(),ir=sr.textContent.trim();if(lr&&lr.length>2&&200>lr.length&&ir&&ir.length>5&&200>ir.length&&(!e.title||lr.toLowerCase()!==e.title.toLowerCase()&&!lr.toLowerCase().includes(e.title.toLowerCase())&&!e.title.toLowerCase().includes(lr.toLowerCase()))&&(ir.includes(",")||/(rue|avenue|boulevard|place|chemin|route|allÃ©e|impasse|street|road|way|drive|france|belgium|belgique)/i.test(ir))){e.venue_name||(e.venue_name=lr,console.log("âœ… [FOMO Bookmarklet] Nom du lieu trouvÃ© via lien (fallback divs):",lr)),e.address||(e.address=ir,console.log("âœ… [FOMO Bookmarklet] Adresse trouvÃ©e via lien (fallback divs):",ir));break}}if(!(e.venue_name&&e.address||2>tr.length)){const cr=tr[0],dr=tr[1];if((!e.title||cr.toLowerCase()!==e.title.toLowerCase()&&!cr.toLowerCase().includes(e.title.toLowerCase())&&!e.title.toLowerCase().includes(cr.toLowerCase()))&&(dr.includes(",")||/(rue|avenue|boulevard|place|chemin|route|allÃ©e|impasse|street|road|way|drive|france|belgium|belgique)/i.test(dr))){e.venue_name||(e.venue_name=cr,console.log("âœ… [FOMO Bookmarklet] Nom du lieu trouvÃ© via lien (fallback spans):",cr)),e.address||(e.address=dr,console.log("âœ… [FOMO Bookmarklet] Adresse trouvÃ©e via lien (fallback spans):",dr));break}}}}if(!e.venue_name&&x){console.log("ğŸ“ [FOMO Bookmarklet] StratÃ©gie SVG: Recherche via icÃ´ne de localisation...");const ur=x.querySelectorAll("svg");console.log("ğŸ“ [FOMO Bookmarklet] Nombre de SVG trouvÃ©s:",ur.length);for(const mr of ur){const pr=mr.querySelectorAll("path");let vr=!1;for(const gr of pr){const kr=gr.getAttribute("d");if(kr&&kr.includes("M10 .5A7.5 7.5 0 0 0 2.5 8")){vr=!0,console.log("ğŸ“ [FOMO Bookmarklet] IcÃ´ne de localisation trouvÃ©e");break}}if(vr){let Or=mr.parentElement,hr=0;const fr=5;for(;Or&&fr>hr;){const xr=Or.querySelectorAll('span, div[role="button"], a, p');for(const yr of xr){const br=yr.textContent.trim();if(br&&br.length>=2&&200>=br.length&&(!e.title||br.toLowerCase()!==e.title.toLowerCase()&&!br.toLowerCase().includes(e.title.toLowerCase())&&!e.title.toLowerCase().includes(br.toLowerCase()))){if(!br.includes(",")){e.venue_name=br,console.log("âœ… [FOMO Bookmarklet] Nom du lieu trouvÃ© (nom simple):",br);break}{const Mr=br.split(",").map(e=>e.trim());if(Mr.length>=2){const wr=Mr[Mr.length-2];if(wr&&wr.length>=2&&100>wr.length){e.venue_name=wr,console.log("âœ… [FOMO Bookmarklet] Nom du lieu extrait de l'adresse (ville):",wr),console.log("ğŸ“ [FOMO Bookmarklet] Adresse complÃ¨te trouvÃ©e:",br),e.address||(e.address=br);break}}}}}if(e.venue_name)break;Or=Or.parentElement,hr++}if(e.venue_name)break}}}console.log("ğŸ“ [FOMO Bookmarklet] Nom du lieu final:",e.venue_name||"NON TROUVÃ‰"),console.log("ğŸ“ [FOMO Bookmarklet] === FIN EXTRACTION ADRESSE ==="),!e.address&&e.venue_name&&(e.address=e.venue_name,console.log("ğŸ“ [FOMO Bookmarklet] Adresse non trouvÃ©e, utilisation du nom du lieu comme adresse:",e.address)),console.log("ğŸ“ [FOMO Bookmarklet] Adresse finale:",e.address||"NON TROUVÃ‰E"),console.log("ğŸ‘¤ [FOMO Bookmarklet] === DÃ‰BUT EXTRACTION ORGANISATEUR ===");const y=t.querySelectorAll("span");for(const Fr of y){const Cr=Fr.textContent.trim();if(Cr&&(Cr.toLowerCase().includes("Ã©vÃ¨nement de")||Cr.toLowerCase().includes("event by")||Cr.toLowerCase().includes("Ã©vÃ©nement de"))){const Br=Fr.querySelectorAll("a"),Sr=[];for(const Ir of Br){const Er=Ir.textContent.trim();Er&&Er.length>0&&Sr.push(Er)}if(Sr.length>0){e.host=Sr.join(" et "),console.log("ğŸ‘¤ [FOMO Bookmarklet] âœ… Organisateur(s) trouvÃ©(s):",e.host);break}}}console.log("ğŸ‘¤ [FOMO Bookmarklet] === FIN EXTRACTION ORGANISATEUR ==="),console.log("ğŸ‘¤ [FOMO Bookmarklet] Organisateur final:",e.host||"NON TROUVÃ‰");const b=['img[data-imgperflogname="profileCoverPhoto"]','img[data-testid="event-cover-photo"]','img[alt*="cover"]','img[alt*="Cover"]','img[alt*="event cover"]'];for(const Ar of b){const jr=document.querySelector(Ar);if(jr&&jr.src&&!jr.src.includes("data:image")){if("profileCoverPhoto"===jr.getAttribute("data-imgperflogname")){e.cover=jr.src,console.log("ğŸ–¼ï¸ [FOMO Bookmarklet] Image de couverture trouvÃ©e via profileCoverPhoto:",jr.src.substring(0,100));break}if(jr.offsetWidth>400||jr.naturalWidth>400){e.cover=jr.src;break}}}if(!e.cover){const Tr=t.querySelectorAll("img");let Lr=null,Dr=0;for(const qr of Tr)if(qr.src&&!qr.src.includes("data:image")&&!qr.src.includes("profile")&&!qr.src.includes("avatar")&&!qr.src.includes("icon")&&(!qr.alt||!qr.alt.toLowerCase().includes("profile"))){const Nr=qr.getBoundingClientRect(),_r=(qr.offsetWidth||qr.naturalWidth||Nr.width)*(qr.offsetHeight||qr.naturalHeight||Nr.height),zr=Nr.top,Rr=_r/100+(1e3>zr?(1e3-zr)/10:0)+(qr.src.includes("scontent")?100:0);_r>5e4&&2e3>zr&&Rr>Dr&&(Dr=Rr,Lr=qr)}if(Lr){let Vr=Lr.src;Vr.includes("scontent")&&Vr.includes("&")&&(Vr=Vr.split("&")[0]+"&ext="),e.cover=Vr}}function M(e){if(!e)return null;let t=e.replace(/\u00A0/g," ").trim().replace(/\s+/g," ");if(/^\d+$/.test(t))return t;const o=t.match(/^(\d+)[,.]?(\d+)?\s*K$/i);if(o){const[,e,t]=o;return t?`${e}.${t}K`.toUpperCase():(e+"K").toUpperCase()}const n=t.match(/^(\d+)[,.]?(\d+)?\s*M$/i);if(n){const[,e,t]=n;return t?`${e}.${t}M`.toUpperCase():(e+"M").toUpperCase()}return null}const w=t.querySelectorAll('span[dir="auto"][class*="xdmh292"], span[dir="auto"][class*="x15dsfln"]');for(const Kr of w){let Hr=Kr.textContent.trim(),Ur=M(Hr);if(null===Ur&&Kr.parentElement){const Pr=Kr.parentElement.textContent.trim();Ur=M(Pr),null!==Ur&&(Hr=Pr)}if(null!==Ur){const $r=Kr.parentElement,Gr=$r?$r.parentElement:null;let Xr=[];if($r&&Xr.push($r.textContent.trim().toLowerCase()),Gr&&Xr.push(Gr.textContent.trim().toLowerCase()),$r){const Wr=Kr.previousElementSibling,Zr=Kr.nextElementSibling;Wr&&Xr.push(Wr.textContent.trim().toLowerCase()),Zr&&Xr.push(Zr.textContent.trim().toLowerCase())}$r&&Array.from($r.parentElement?$r.parentElement.children:[]).forEach(e=>{e!==$r&&Xr.push(e.textContent.trim().toLowerCase())});const Yr=Xr.join(" ");(Yr.includes("participant")||Yr.includes("going")||Yr.includes("vont")||Yr.includes("participer")||Yr.includes("personne")||Yr.includes("va"))&&(e.attending_count||(e.attending_count=Ur,console.log("ğŸ‘¥ [FOMO Bookmarklet] Participants trouvÃ©s via span:",Ur))),(Yr.includes("intÃ©ressÃ©")||Yr.includes("interested")||Yr.includes("s'intÃ©resse"))&&(e.interested_count||(e.interested_count=Ur,console.log("ğŸ‘€ [FOMO Bookmarklet] IntÃ©ressÃ©s trouvÃ©s via span:",Ur)))}}const F=document.body.textContent||"",C=[/(\d+(?:[.,]\d+)?\s*[KM]?)\s*(personnes|people|participants|going|participent|vont|participeront)/i,/(\d+(?:[.,]\d+)?\s*[KM]?)\s*(personne|person|participant|va|participera)/i,/going[:\s]+(\d+(?:[.,]\d+)?\s*[KM]?)/i,/participants[:\s]+(\d+(?:[.,]\d+)?\s*[KM]?)/i];for(const Jr of C){const Qr=F.match(Jr);if(Qr){const ea=M(Qr[1].trim());null===ea||e.attending_count||(e.attending_count=ea);break}}const B=[/(\d+(?:[.,]\d+)?\s*[KM]?)\s*(intÃ©ressÃ©s|interested|intÃ©ressÃ©es|s'intÃ©ressent)/i,/(\d+(?:[.,]\d+)?\s*[KM]?)\s*(intÃ©ressÃ©|interested)/i,/interested[:\s]+(\d+(?:[.,]\d+)?\s*[KM]?)/i,/intÃ©ressÃ©s[:\s]+(\d+(?:[.,]\d+)?\s*[KM]?)/i];for(const ta of B){const oa=F.match(ta);if(oa){const na=M(oa[1].trim());null===na||e.interested_count||(e.interested_count=na);break}}const S=document.querySelectorAll('button, [role="button"]');for(const ra of S){const aa=ra.textContent.trim(),sa=aa.match(/(\d+(?:[.,]\d+)?\s*[KM]?)\s*(going|participants|vont)/i);if(sa){const ia=M(sa[1].trim());null===ia||e.attending_count||(e.attending_count=ia)}const la=aa.match(/(\d+(?:[.,]\d+)?\s*[KM]?)\s*(interested|intÃ©ressÃ©s)/i);if(la){const ca=M(la[1].trim());null===ca||e.interested_count||(e.interested_count=ca)}}}catch(da){console.error("Erreur extraction donnÃ©es:",da)}return console.log("ğŸ” [FOMO Bookmarklet] DonnÃ©es extraites:",e),console.log("ğŸ” [FOMO Bookmarklet] Champs remplis:",{title:!!e.title,description:!!e.description,start:!!e.start,end:!!e.end,venue_name:!!e.venue_name,address:!!e.address,host:!!e.host,cover:!!e.cover,attending_count:e.attending_count,interested_count:e.interested_count}),e}(),0,()=>{window.__FOMO_BOOKMARKLET_ACTIVE=!1})}catch(e){alert("Erreur: "+e.message),window.__FOMO_BOOKMARKLET_ACTIVE=!1}}()):alert("âš ï¸ Ce bookmarklet doit Ãªtre utilisÃ© sur une page d'Ã©vÃ©nement Facebook.\n\nOuvrez une page d'Ã©vÃ©nement Facebook (ex: facebook.com/events/...) puis rÃ©essayez.")}();